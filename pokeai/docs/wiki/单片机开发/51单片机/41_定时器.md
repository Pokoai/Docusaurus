---
position: 7
---

```c

// 头文件
#include <reg52.h>

// 类型重定义
typedef unsigned char u8;
typedef unsigned int u16;

// 管脚定义
#define LED P0  

// 全局变量
bit flag;  

// ms 延时函数
static void delay_ms(u16 n)
{
    n *= 23;
    while (n--);
}


// 定时器初始化
void timer_init()
{
    // 1.设置工作方式
    TMOD = 0x01;  // 定时器0：方式1

    //  2.装初值
    TH0 = (65535 - 50000) / 256;  // 50ms
    TL0 = (65535 - 50000) % 256;

    // 3.开总中断、定时器中断允许位、定时器中断
    EA = 1;
    ET0 = 1;
    TR0 = 1;
}

// 定时器0中断服务函数
void timer0() interrupt 1
{
    //  装初值
    TH0 = (65535 - 50000) / 256; 
    TL0 = (65535 - 50000) % 256;

    // 50ms 以内的程序可以直接写在中断服务函数里
    // 超过的可以借助标志位，将服务函数写到主函数中
    flag = 1;
}

void main()
{   
    timer_init();
    
    while (1) {
        if ( flag ) {
            flag = 0;  // 马上清0
            ......
        }
    }
}

```